async function getResponseBody(response: Response): Promise<any> {
    try {
        const contentType = response.headers.get('Content-Type');
        const contentDisposition = response.headers.get('Content-Disposition');
        console.log(contentDisposition, 'current dispostion header');
        for(let item of response.headers) {
          console.log(item, 'available headers');
        }
        
        if (contentType) {

            const jsonTypes = ['application/json', 'application/problem+json']
            const isJSON = jsonTypes.some(type => contentType.toLowerCase().startsWith(type));

            //Check for the blob types
            const blobTypes = ['application/vnd.openxmlformats-officedocument.wordprocessingml.document', 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet']
            const isBlob = blobTypes.some(type => contentType.toLowerCase().startsWith(type));

            if (isJSON) {
              return await response.json();
            }else if (isBlob) { 
                const arrayBuffer = await response.arrayBuffer();
  
                if(contentDisposition) {
                  return [contentDisposition, arrayBuffer];
                } else {
                  return arrayBuffer;
                }
              } else {
                return await response.text();
            }
        }
    } catch (error) {
        console.error(error);
    }
    return null;
}